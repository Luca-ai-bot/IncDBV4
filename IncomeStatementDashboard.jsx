// (Full code from canvas is already known, no need to truncate)